{"ast":null,"code":"var _jsxFileName = \"E:\\\\Nemo\\\\bd-frontend-full\\\\src\\\\context\\\\TaskContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useCallback } from 'react';\nimport { taskService } from '../services/tasks';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TaskContext = /*#__PURE__*/createContext({});\nexport const useTasks = () => {\n  _s();\n  return useContext(TaskContext);\n};\n_s(useTasks, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const TaskProvider = ({\n  children\n}) => {\n  _s2();\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [pagination, setPagination] = useState({\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    perPage: 10\n  });\n  const [filters, setFilters] = useState({\n    status: '',\n    search: ''\n  });\n  console.log('TaskProvider - tasks:', tasks);\n  console.log('TaskProvider - loading:', loading);\n  const fetchTasks = useCallback(async (page = 1, newFilters = filters) => {\n    setLoading(true);\n    try {\n      var _response$meta, _response$meta2, _response$meta3, _response$meta4;\n      const response = await taskService.getAll(page, newFilters);\n      setTasks(response.data || []);\n      setPagination({\n        currentPage: ((_response$meta = response.meta) === null || _response$meta === void 0 ? void 0 : _response$meta.current_page) || 1,\n        totalPages: ((_response$meta2 = response.meta) === null || _response$meta2 === void 0 ? void 0 : _response$meta2.total_pages) || 1,\n        totalItems: Number((_response$meta3 = response.meta) === null || _response$meta3 === void 0 ? void 0 : _response$meta3.total) || 0,\n        // تحويل إلى number\n        perPage: ((_response$meta4 = response.meta) === null || _response$meta4 === void 0 ? void 0 : _response$meta4.per_page) || 10\n      });\n    } catch (error) {\n      console.error('Error fetching tasks:', error);\n      toast.error('فشل تحميل المهام');\n      setTasks([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [filters]);\n  const createTask = async taskData => {\n    try {\n      const response = await taskService.create(taskData);\n      const newTask = response.task || response.data;\n      setTasks(prev => {\n        const newTasks = [newTask, ...prev];\n        return newTasks.slice(0, pagination.perPage);\n      });\n      toast.success('تم إنشاء المهمة بنجاح');\n      return {\n        success: true,\n        task: newTask\n      };\n    } catch (error) {\n      var _error$response, _error$response$data, _error$response2;\n      console.error('Error creating task:', error);\n      toast.error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'فشل إنشاء المهمة');\n      return {\n        success: false,\n        error: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data\n      };\n    }\n  };\n  const updateTask = async (id, taskData) => {\n    try {\n      const response = await taskService.update(id, taskData);\n      const updatedTask = response.task || response.data;\n      setTasks(prev => prev.map(task => task.id === id ? {\n        ...task,\n        ...updatedTask\n      } : task));\n      toast.success('تم تحديث المهمة بنجاح');\n      return {\n        success: true,\n        task: updatedTask\n      };\n    } catch (error) {\n      var _error$response3, _error$response3$data, _error$response4;\n      console.error('Error updating task:', error);\n      toast.error(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || 'فشل تحديث المهمة');\n      return {\n        success: false,\n        error: (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data\n      };\n    }\n  };\n  const deleteTask = async id => {\n    try {\n      await taskService.delete(id);\n      setTasks(prev => prev.filter(task => task.id !== id));\n      toast.success('تم حذف المهمة بنجاح');\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Error deleting task:', error);\n      toast.error('فشل حذف المهمة');\n      return {\n        success: false\n      };\n    }\n  };\n  const updateFilters = newFilters => {\n    const updatedFilters = {\n      ...filters,\n      ...newFilters\n    };\n    setFilters(updatedFilters);\n    fetchTasks(1, updatedFilters);\n  };\n  const changePage = page => {\n    fetchTasks(page);\n  };\n  const getTaskStats = () => {\n    const stats = {\n      total: tasks.length,\n      pending: tasks.filter(t => t.status === 'pending').length,\n      in_progress: tasks.filter(t => t.status === 'in_progress').length,\n      done: tasks.filter(t => t.status === 'done').length\n    };\n    return {\n      ...stats,\n      completionRate: stats.total > 0 ? Math.round(stats.done / stats.total * 100) : 0\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(TaskContext.Provider, {\n    value: {\n      tasks,\n      loading,\n      pagination,\n      filters,\n      fetchTasks,\n      createTask,\n      updateTask,\n      deleteTask,\n      updateFilters,\n      changePage,\n      getTaskStats\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n};\n_s2(TaskProvider, \"yyGlnJGkzj7KVThU8v3g11XbVTg=\");\n_c = TaskProvider;\nvar _c;\n$RefreshReg$(_c, \"TaskProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useCallback","taskService","toast","jsxDEV","_jsxDEV","TaskContext","useTasks","_s","TaskProvider","children","_s2","tasks","setTasks","loading","setLoading","pagination","setPagination","currentPage","totalPages","totalItems","perPage","filters","setFilters","status","search","console","log","fetchTasks","page","newFilters","_response$meta","_response$meta2","_response$meta3","_response$meta4","response","getAll","data","meta","current_page","total_pages","Number","total","per_page","error","createTask","taskData","create","newTask","task","prev","newTasks","slice","success","_error$response","_error$response$data","_error$response2","message","updateTask","id","update","updatedTask","map","_error$response3","_error$response3$data","_error$response4","deleteTask","delete","filter","updateFilters","updatedFilters","changePage","getTaskStats","stats","length","pending","t","in_progress","done","completionRate","Math","round","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["E:/Nemo/bd-frontend-full/src/context/TaskContext.jsx"],"sourcesContent":["import React, { createContext, useState, useContext, useCallback } from 'react';\r\nimport { taskService } from '../services/tasks';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst TaskContext = createContext({});\r\n\r\nexport const useTasks = () => useContext(TaskContext);\r\n\r\nexport const TaskProvider = ({ children }) => {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [pagination, setPagination] = useState({\r\n    currentPage: 1,\r\n    totalPages: 1,\r\n    totalItems: 0,\r\n    perPage: 10\r\n  });\r\n  const [filters, setFilters] = useState({\r\n    status: '',\r\n    search: ''\r\n  });\r\n\r\n  console.log('TaskProvider - tasks:', tasks); \r\n  console.log('TaskProvider - loading:', loading); \r\n\r\n  const fetchTasks = useCallback(async (page = 1, newFilters = filters) => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await taskService.getAll(page, newFilters);\r\n      setTasks(response.data || []);\r\n      setPagination({\r\n        currentPage: response.meta?.current_page || 1,\r\n        totalPages: response.meta?.total_pages || 1,\r\n        totalItems: Number(response.meta?.total) || 0, // تحويل إلى number\r\n        perPage: response.meta?.per_page || 10\r\n      });\r\n    } catch (error) {\r\n      console.error('Error fetching tasks:', error);\r\n      toast.error('فشل تحميل المهام');\r\n      setTasks([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters]);\r\n\r\n  const createTask = async (taskData) => {\r\n    try {\r\n      const response = await taskService.create(taskData);\r\n      const newTask = response.task || response.data;\r\n      \r\n      \r\n      setTasks(prev => {\r\n        const newTasks = [newTask, ...prev];\r\n        return newTasks.slice(0, pagination.perPage); \r\n      });\r\n      \r\n      toast.success('تم إنشاء المهمة بنجاح');\r\n      return { success: true, task: newTask };\r\n    } catch (error) {\r\n      console.error('Error creating task:', error);\r\n      toast.error(error.response?.data?.message || 'فشل إنشاء المهمة');\r\n      return { success: false, error: error.response?.data };\r\n    }\r\n  };\r\n\r\n  const updateTask = async (id, taskData) => {\r\n    try {\r\n      const response = await taskService.update(id, taskData);\r\n      const updatedTask = response.task || response.data;\r\n      \r\n     \r\n      setTasks(prev => prev.map(task => \r\n        task.id === id ? { ...task, ...updatedTask } : task\r\n      ));\r\n      \r\n      toast.success('تم تحديث المهمة بنجاح');\r\n      return { success: true, task: updatedTask };\r\n    } catch (error) {\r\n      console.error('Error updating task:', error);\r\n      toast.error(error.response?.data?.message || 'فشل تحديث المهمة');\r\n      return { success: false, error: error.response?.data };\r\n    }\r\n  };\r\n\r\n  const deleteTask = async (id) => {\r\n    try {\r\n      await taskService.delete(id);\r\n      \r\n     \r\n      setTasks(prev => prev.filter(task => task.id !== id));\r\n      \r\n      toast.success('تم حذف المهمة بنجاح');\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('Error deleting task:', error);\r\n      toast.error('فشل حذف المهمة');\r\n      return { success: false };\r\n    }\r\n  };\r\n\r\n  const updateFilters = (newFilters) => {\r\n    const updatedFilters = { ...filters, ...newFilters };\r\n    setFilters(updatedFilters);\r\n    fetchTasks(1, updatedFilters);\r\n  };\r\n\r\n  const changePage = (page) => {\r\n    fetchTasks(page);\r\n  };\r\n\r\n  const getTaskStats = () => {\r\n    const stats = {\r\n      total: tasks.length,\r\n      pending: tasks.filter(t => t.status === 'pending').length,\r\n      in_progress: tasks.filter(t => t.status === 'in_progress').length,\r\n      done: tasks.filter(t => t.status === 'done').length\r\n    };\r\n    \r\n    return {\r\n      ...stats,\r\n      completionRate: stats.total > 0 \r\n        ? Math.round((stats.done / stats.total) * 100) \r\n        : 0\r\n    };\r\n  };\r\n\r\n  return (\r\n    <TaskContext.Provider value={{\r\n      tasks,\r\n      loading,\r\n      pagination,\r\n      filters,\r\n      fetchTasks,\r\n      createTask,\r\n      updateTask,\r\n      deleteTask,\r\n      updateFilters,\r\n      changePage,\r\n      getTaskStats\r\n    }}>\r\n      {children}\r\n    </TaskContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}